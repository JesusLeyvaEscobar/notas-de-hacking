# Objetivo

En RSA d es mucho más grande que e, ¿por qué no usamos d para cifrar en lugar de e? Conéctese con `nc jupiter.challenges.picoctf.org 18243`.
1. ¿Qué es `e` en general?
## Solución

En la descripción del reto, nos dice que ahora vamos a usar d en lugar de e para encriptar una llave.
Ahora, basándonos en las notas que realizamos:
```
c - Texto cifrado
m - mensaje texto plano
p - primo 1
q - primo 2
n - modulo
tn - totient n (euler)
e - exponente (llave publica) 2^16~+1=65537
d - llave privada

n = p * q
tn = (p-1)*(q-1)
d = e mod inv tn / inverse(e,tn)

Encriptar	: c = m ^ e mod n / pow(m,e,n)
Desencriptar	: m = c ^ d mod n / pow(c,d,n)
```
Teóricamente, solo tendríamos que cambiar la `d`, por `e`, en la formula, a la hora de desencriptar pero esto va mas allá, porque también tendremos que cambiar los valores que tomara cada variable `e` y `d`.

Bueno, ahora: Al realizar la conexión que nos pide el reto, obtenemos los siguientes datos:
```
┌──(jesus㉿KaliJesus)-[~/Desktop/github/notas-de-hacking/RetosCrypto_pt2]
└─$  nc jupiter.challenges.picoctf.org 18243
c: 12194255432898944769054412606754770911454336789858773607974345768731278286113309325107419505431553660829944271013959776612621730905957648664009926719054105580498226749635693408901617162814728504434106185654684116607738534002922128488485867503883109523947558106660476087665328532046774847406513888813594289127
n: 72354832551614920847651165010522946206121552263944519178511790006774950026340788620943084387738260283621996520637061773255550193258215569634923384262724672941364976337648112480818235331720120539689729688288031106319275561010429673546520040164343793921063561899116962871297693050025601151562058272920400221369
e: 6139512394823238397146468843912875228531088578052023607301281172889749257617546203229694558496917244262354435681564620307217520251292198036831239450768448533705842032331554063798839486285634974345937728066295852988204253854593817942308123188765274166370911253343658527329031431061449071867237841569071682561
```
Usaremos python para poder realizar las operaciones necesarias, pero teniendo cuidado de realizar los cambios de las variables para poder resolver el reto de manera correcta. Obtenemos lo siguiente:
``` 
┌──(jesus㉿KaliJesus)-[~]
└─$ python3
Python 3.11.6 (main, Oct  8 2023, 05:06:43) [GCC 13.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> c = 12194255432898944769054412606754770911454336789858773607974345768731278286113309325107419505431553660829944271013959776612621730905957648664009926719054105580498226749635693408901617162814728504434106185654684116607738534002922128488485867503883109523947558106660476087665328532046774847406513888813594289127
>>> n = 72354832551614920847651165010522946206121552263944519178511790006774950026340788620943084387738260283621996520637061773255550193258215569634923384262724672941364976337648112480818235331720120539689729688288031106319275561010429673546520040164343793921063561899116962871297693050025601151562058272920400221369
>>> d = 6139512394823238397146468843912875228531088578052023607301281172889749257617546203229694558496917244262354435681564620307217520251292198036831239450768448533705842032331554063798839486285634974345937728066295852988204253854593817942308123188765274166370911253343658527329031431061449071867237841569071682561
>>> e = 65537
>>> m = pow(c,e,n)
>>> m
180638594769037903267909311328535969949661653466129492033745533
>>> from Crypto.Util.number import long_to_bytes
>>> long_to_bytes(m)
b'picoCTF{bad_1d3a5_4783252}'
>>> 
```
## Notas adicionales

 `Algoritmo asimetrico`-> RSA (Rivest, Shamir y Adleman) es un sistema criptográfico de clave pública desarrollado en 1979, que utiliza factorización de números enteros. Es el primer y más utilizado algoritmo de este tipo y es válido tanto para cifrar como para firmar digitalmente.
## Referencias

- https://simple.wikipedia.org/wiki/RSA_algorithm
